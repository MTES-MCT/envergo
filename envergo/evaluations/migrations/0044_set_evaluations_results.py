# Generated by Django 3.2.6 on 2022-01-06 13:52

from django.db import migrations

soumis = 1
non_soumis = 2
action_requise = 3


def set_evaluations_results(apps, schema_editor):
    Evaluation = apps.get_model("evaluations", "Evaluation")
    evals = Evaluation.objects.prefetch_related("criterions")
    for eval in evals:
        results = [criterion.result for criterion in eval.criterions.all()]

        if soumis in results:
            eval.result = soumis
        else:
            eval.result = non_soumis
        eval.save()


class Migration(migrations.Migration):

    dependencies = [
        ("evaluations", "0043_set_criterions_results"),
    ]

    operations = [
        migrations.RunPython(set_evaluations_results, migrations.RunPython.noop),
    ]
