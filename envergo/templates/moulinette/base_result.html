{% extends 'moulinette/base.html' %}

{% load evaluations static l10n %}

{% block header %}
  <header role="banner" class="fr-header header-sticky header-slim">
    {% include '_slim_header.html' %}

  </header>
{% endblock %}

{% block html-classes %}full-height{% endblock %}
{% block body-classes %}full-height flex-box flex-column moulinette-result-body{% endblock %}
{% block main-classes %}full-height flex-box flex-column{% endblock %}

{% block container %}
  <div id="moulinette-result-container" class="flex-box fr-container">
    <div class="fr-grid-row">
      <div id="mobile-footer" class="fr-hidden-lg fr-col-12 hide-print fr-mt-4w">
        {% block mobile-footer %}{% endblock %}
      </div>
      <div id="project-summary" class="fr-col-12 fr-col-lg-4 fr-py-4w fr-px-2w">
        <section>
          <h2 class="fr-mb-5w">Caractéristiques du projet</h2>
          <p class="fr-text print-only">
            Simulation réalisée sur <a title="EnvErgo : la réglementation environnementale pour les projets de construction et d'aménagement"
    href="{{ envergo_url }}"
    target="_blank"
    rel="noopener external">EnvErgo</a>
          </p>
          <p class="fr-text print-only">
            Cette simulation est <a title="Partager l'avis réglementaire"
    href="{{ share_print_url }}"
    target="_blank"
    class="share-link"
    rel="noopener external">consultable en ligne</a>
          </p>
          {% block project_summary %}{% endblock %}
          <div class="button-container  hide-print">
            <a href="{{ edit_url }}"
               class="fr-btn fr-btn--secondary fr-mt-3w fr-btn--icon-left fr-icon-arrow-left-line"
               data-event-category="Content"
               data-event-action="Edit"
               data-event-name="Project">Modifier le projet</a>
          </div>
        </section>
      </div>
      <div id="project-result" class="fr-col-12 fr-col-lg-8">
        <section class="fr-py-4w fr-px-4w">
          {% block result %}{% endblock %}
        </section>
        <div class="fr-hidden fr-unhidden-lg">
          <section class="fr-py-8w fr-px-6w alt">
            {% block include_learn_more %}{% endblock %}
          </section>
          <section class="fr-footer fr-pb-2w hide-print" role="contentinfo">
            {% block include_desktop_footer %}{% endblock %}
          </section>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block after-content %}{% endblock %}
{% block footer %}
  {% include 'moulinette/_actions_banner.html' %}
{% endblock %}

{% block extra_body %}
  {% include '_share_url_modal.html' with title="Partager cette simulation" content='<p>Avec ce lien le destinataire pourra directement consulter cette page web présentant :</p> <ul class="fr-mb-0w"> <li>les mêmes caractéristiques de projet (localisation et surfaces) ;</li> <li>les mêmes résultats de simulation.</li> </ul>' shorten_url=True share_url=share_btn_url %}
  {% if display_feedback_form %}
    {% include 'analytics/_feedback_modal_useful.html' %}
    {% include 'analytics/_feedback_modal_useless.html' %}
  {% endif %}
{% endblock %}

{% block extra_js %}
  <script>
    var DEPARTMENT = "{{ moulinette.department.department }}";
    var SHARING_URL = "{{ current_url }}";
    window.MAPS = window.MAPS || {};
    window.MAPS['map'] = {
      center: {coordinates: [{{ center_map.0|unlocalize }}, {{ center_map.1|unlocalize }}]},
      entries: [],
      caption: null,
      truncate: true,
      zoom: 15,
      ratio: "4x3",
      fixed: {
        zoomControl: true,
        dragging: false,
        doubleClickZoom: 'center',
        scrollWheelZoom: false,
        touchZoom: 'center',
        keyboard: true,
      }
    };
  </script>

  <script defer src="{% static 'leaflet/dist/leaflet.js' %}"></script>
  <script defer src="{% static 'leaflet/draw/leaflet.draw.js' %}"></script>
  <script defer src="{% static 'js/libs/leaflet-icon-fix.js' %}"></script>
  <script defer src="{% static 'js/libs/moulinette_result_maps.js' %}"></script>
  <script defer src="{% static 'js/libs/moulinette_analytics.js' %}"></script>
  <script defer
          src="{% static 'js/libs/moulinette_result_actions_banner.js' %}"></script>
  <script defer src="{% static 'js/libs/urlmappings.js' %}"></script>
  <script defer src="{% static 'js/libs/share_url_modal.js' %}"></script>
  <script defer src="{% static 'js/libs/moulinette_print_buttons.js' %}"></script>
{% endblock %}
