{% extends 'moulinette/base_result.html' %}
{% load evaluations static %}

{% block result %}

  <h1 class="fr-mb-5w">Réglementations environnementales : évaluation personnalisée</h1>

  {% for regulation in moulinette.regulations %}
    {% include 'moulinette/_result_regulation.html' with regulation=regulation %}
  {% endfor %}

  <section class="regulation regulation-disabled fr-mb-5w" id="regulation_natura200">
    <h2><span class="content">Natura 2000</span> {% result_tag 'non_disponible' %}</h2>
    <p>Cette réglementation sera prochainement prise en compte dans EnvErgo.
      Vous pouvez <a target="_blank" rel="noopener" href="https://startupdetat.typeform.com/envergo-regl">voter pour la demander en priorité</a>.</p>
  </section>

  <section class="regulation regulation-disabled fr-mb-5w" id="regulation_natura200">
    <h2><span class="content">Risque sismique</span> {% result_tag 'non_disponible' %}</h2>
    <p>Cette réglementation sera prochainement prise en compte dans EnvErgo.
      Vous pouvez <a target="_blank" rel="noopener" href="https://startupdetat.typeform.com/envergo-regl">voter pour la demander en priorité</a>.</p>

  </section>

  <section class="regulation regulation-disabled fr-mb-5w" id="regulation_natura200">
    <h2><span class="content">Évaluation environnementale</span> {% result_tag 'non_disponible' %}</h2>
    <p>Cette réglementation sera prochainement prise en compte dans EnvErgo.
      Vous pouvez <a target="_blank" rel="noopener" href="https://startupdetat.typeform.com/envergo-regl">voter pour la demander en priorité</a>.</p>

  </section>

  <section class="regulation regulation-disabled fr-mb-5w" id="regulation_natura200">
    <h2><span class="content">ZNIEFF</span> {% result_tag 'non_disponible' %}</h2>
    <p>Cette réglementation sera prochainement prise en compte dans EnvErgo.
      Vous pouvez <a target="_blank" rel="noopener" href="https://startupdetat.typeform.com/envergo-regl">voter pour la demander en priorité</a>.</p>

  </section>

  <section class="fr-my-8w">

    <div class="fr-alert fr-alert--info">
      <p class="fr-mb-3w">
        Obtenez une évaluation approfondie de votre projet, réalisée manuellement
        par l'équipe EnvErgo. Réponse en 2 jours ouvrés.
      </p>
      <p>
        <a class="fr-btn fr-btn--secondary fr-mb-2w" href="{% url "request_evaluation" %}">
          Demander une évaluation approfondie
        </a>
      </p>
    </div>
  </section>

{% endblock %}

{% block extra_js %}
  {{ block.super }}
  <script defer src="{% static 'js/libs/moulinette_accordion_maps.js' %}"></script>
  <script defer src="{% static 'js/libs/accordion_analytics.js' %}"></script>
  <script>
    window.addEventListener('load', function() {
      const accordion = document.querySelector('div.criteria');
      new AccordionAnalytics(accordion);
    });
  </script>

  <script>
    var _paq = window._paq || [];

    // Track an event when a regulation main "read more" btn is clicked
    window.addEventListener('load', function() {
      const showMoreBtns = document.querySelectorAll('section.regulation div.alt button.read-more-btn');
      showMoreBtns.forEach(btn => btn.addEventListener('click', function(evt) {
        const btn = evt.currentTarget;
        const target = btn.getAttribute('aria-controls');
        const expanded = btn.getAttribute('aria-expanded');
        const action = expanded == 'false' ? 'Expand' : 'Conceal';
        _paq.push(['trackEvent', 'Content', action, target]);
      }));
    });
  </script>

{% endblock %}
